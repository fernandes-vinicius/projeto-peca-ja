<!DOCTYPE html>
<html layout:decorate="~{template}">
<head>
<meta charset="UTF-8">
<title th:text="'Histórico de compras do mês de ' + ${msgMesEano}"></title>
</head>
<body>

	<!-- /* Content of this page will be decorated by the elements of layout.html (task/layout) */ -->
	<section layout:fragment="content">

		<div class="container-fluid">
			<!-- page content -->
			<div class="container" role="main">
				<div class="">
					<div class="row top_tiles">
						<div class="animated flipInY col-lg-4 col-md-4 col-sm-6 col-xs-12">
							<div class="tile-stats">
								<div class="icon">
									<i class="fa fa-check-square-o"></i>
								</div>
								<div class="count">
									<h1 th:text="${estoqueProdutos}" class="count"></h1>
								</div>
								<h3>Estoque de Produtos</h3>
								<p>Estoque de produtos do Revendedor.</p>
							</div>
						</div>
						<div class="animated flipInY col-lg-4 col-md-4 col-sm-6 col-xs-12">
							<div class="tile-stats">
								<div class="icon">
									<i class="glyphicon glyphicon-shopping-cart"></i>
								</div>
								<div class="count">
									<h1 th:text="${quantidadeVendas}" class="count"></h1>
								</div>
								<h3>Total de Vendas</h3>

								<p>Quantidade de vendas.</p>
							</div>
						</div>
						<div class="animated flipInY col-lg-4 col-md-4 col-sm-6 col-xs-12">
							<div class="tile-stats">
								<div class="icon">
									<i class="glyphicon glyphicon-usd"></i>
								</div>
								<div class="count">
									<h1 th:text="${valorTotalVendas}" class="count"></h1>
								</div>
								<h3>Valor total das vendas</h3>
								<p>Historico das vendas efetuadas.</p>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-md-2 col-sm-9 col-xs-12" style="float: right;">
							<div class="input-prepend input-group">
								<span class="add-on input-group-addon"><i
									class="glyphicon glyphicon-calendar fa fa-calendar"></i></span> <select
									class="form-control" name="mes" id="mes">
									<option value="0">Mês Atual</option>
									<option value="1">Janeiro</option>
									<option value="2">Fevereiro</option>
									<option value="3">Março</option>
									<option value="4">Abril</option>
									<option value="5">Maio</option>
									<option value="6">Junho</option>
									<option value="7">Julho</option>
									<option value="8">Agosto</option>
									<option value="9">Setembro</option>
									<option value="10">Outubro</option>
									<option value="11">Novembro</option>
									<option value="12">Dezembro</option>
								</select>
							</div>
						</div>
						<div class="col-md-2 col-sm-9 col-xs-12" style="float: right;">
							<div class="input-prepend input-group">
								<span class="add-on input-group-addon"><i
									class="glyphicon glyphicon-calendar fa fa-calendar"></i></span>
									<select class="form-control" name="ano" id="ano">
									<option value="0" selected="selected">Ano Atual</option>
									<option value="2018">2018</option>
									<option value="2019">2019</option>
									<option value="2020">2020</option>
								</select>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-md-12 col-sm-12 col-xs-12" id="conteudo">
							<div class="x_panel">

								<div class="x_title">
									<h2
										th:text="'Histórico de vendas do mês de ' + ${msgMesEano}">
									</h2>
									<ul class="nav navbar-right panel_toolbox">
										<li><a class="collapse-link"><i
												class="fa fa-chevron-up"></i></a></li>
									</ul>
									<div class="clearfix"></div>
								</div>

								<div class="x_content">
									<br /> <br />

									<div class="count">
										<div id="openIcon" style="text-align: center" align="center"></div>
									</div>

									<div th:if="${#lists.isEmpty(pedidos)}" align="center">
										<h2 class="count" id="msgMesEano"
											th:text="'Nenhuma compra no mês de ' + ${msgMesEano}"></h2>
									</div>

									<!-- Table -->
									<div class="table-responsive" id="dataTable"
										th:unless="${#lists.isEmpty(pedidos)}">

										<table id="datatable-buttons"
											class="table table-striped table-bordered">
											<thead>
												<tr>
													<th>Cliente</th>
													<th>Endereço</th>
													<th>Produto</th>
													<th>Marca</th>
													<th>Quantidade</th>
													<th>Preço Uni.</th>
													<th>Data</th>
												</tr>
											</thead>

											<tbody>
												<tr th:each="pedido : ${pedidos}">
													<td th:text="${pedido.cliente.nome}"></td>
													<td th:text="${pedido.cliente.endereco.rua}"></td>
													<td th:text="${pedido.produto.categoria.nome}"></td>
													<td th:text="${pedido.produto.marca.nome}"></td>
													<td th:text="${pedido.quantidade}"></td>
													<td th:text="${pedido.produto.preco}"></td>
													<td th:text="${pedido.data}"></td>
												</tr>
											</tbody>

										</table>

									</div>

								</div>

							</div>
						</div>
					</div>

				</div>
			</div>
		</div>
		<!-- /page content -->
	</section>
	<!-- End Content -->
</body>


<th:block xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:fragment="end">

	<!-- jQuery -->
	<script th:src="@{/vendors/jquery/dist/jquery.min.js}">
	</script>
	<!-- Bootstrap -->
	<script th:src="@{/vendors/bootstrap/dist/js/bootstrap.min.js}"></script>
	<!-- FastClick -->
	<script th:src="@{/vendors/fastclick/lib/fastclick.js}"></script>
	<!-- NProgress -->
	<script th:src="@{/vendors/nprogress/nprogress.js}"></script>
	<!-- Chart.js -->
	<script th:src="@{/vendors/Chart.js/dist/Chart.min.js}"></script>
	<!-- gauge.js -->
	<script th:src="@{/vendors/gauge.js/dist/gauge.min.js}"></script>
	<!-- Morris.js -->
	<script th:src="@{/vendors/morris.js/morris.min.js}"></script>
	<!-- Rapahel.js -->
	<script th:src="@{/vendors/raphael/raphael.min.js}"></script>
	<!-- Bootstrap-progressbar -->
	<script
		th:src="@{/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js}"></script>
	<!-- iCheck -->
	<script th:src="@{/vendors/iCheck/icheck.min.js}"></script>
	<!-- Skycons -->
	<script th:src="@{/vendors/skycons/skycons.js}"></script>

	<!-- Datatable Js -->
	<script th:src="@{/vendors/datatables.net/js/jquery.dataTables.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-buttons/js/dataTables.buttons.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-buttons/js/buttons.flash.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-buttons/js/buttons.html5.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-buttons/js/buttons.print.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-responsive/js/dataTables.responsive.min.js}"></script>
	<script
		th:src="@{/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js}"></script>
	<script
		th:src="@{vendors/datatables.net-scroller/js/dataTables.scroller.min.js}"></script>
	<script th:src="@{/vendors/jszip/dist/jszip.min.js}"></script>
	<script th:src="@{/vendors/pdfmake/build/pdfmake.min.js}"></script>
	<script th:src="@{/vendors/pdfmake/build/vfs_fonts.js}"></script>

	<!-- Custom Theme Script@s -->
	<script th:src="@{/js/custom.min.js}"></script>

	<!--Script responsável por fazer requisições via GET, para alternar o historico por mês -->
	<script>
		$("#mes")
				.change(
						function() {
							$("#msgMesEano").hide();
							$("#dataTable").hide();
							$("#openIcon")
									.html(
											'<div class="load"><i class="fa fa-circle-o-notch fa-spin fa-3x" style="font-size:35px; color:#BAB8B8"></i></div>');
							
							var mes = $("#mes").val();		
							var ano = $("#ano").val();		
							var url = "/revendedor/ajaxHistorico/" + mes + "/" + ano ;
							
							$.get(url, function(data) {
								$("#conteudo").html(data);
								$(".load").hide();
							}, 'html');

						});
		$("#ano")
		.change(
				function() {
					$("#msgMesEano").hide();
					$("#dataTable").hide();
					$("#openIcon")
							.html(
									'<div class="load"><i class="fa fa-circle-o-notch fa-spin fa-3x" style="font-size:35px; color:#BAB8B8"></i></div>');
					
					var mes = $("#mes").val();		
					var ano = $("#ano").val();		

					var url = "/revendedor/ajaxHistorico/" + mes + "/" + ano ;
					
					$.get(url, function(data) {
						$("#conteudo").html(data);
						$(".load").hide();
					}, 'html');

				});
	</script>


</th:block>
<!-- 	END fragment scripts -->

</html>